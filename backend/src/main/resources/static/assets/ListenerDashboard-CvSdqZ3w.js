import{r as a,j as e,b as q,c as C,p as v,s as O}from"./index-s7VrMFch.js";function J({title:m,titleId:g,...u},f){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:f,"aria-labelledby":g},u),m?a.createElement("title",{id:g},m):null,a.createElement("path",{fillRule:"evenodd",d:"M19.952 1.651a.75.75 0 0 1 .298.599V16.303a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.403-4.909l2.311-.66a1.5 1.5 0 0 0 1.088-1.442V6.994l-9 2.572v9.737a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.402-4.909l2.31-.66a1.5 1.5 0 0 0 1.088-1.442V5.25a.75.75 0 0 1 .544-.721l10.5-3a.75.75 0 0 1 .658.122Z",clipRule:"evenodd"}))}const L=a.forwardRef(J);function G({title:m,titleId:g,...u},f){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:f,"aria-labelledby":g},u),m?a.createElement("title",{id:g},m):null,a.createElement("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"}))}const z=a.forwardRef(G);function X({title:m,titleId:g,...u},f){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:f,"aria-labelledby":g},u),m?a.createElement("title",{id:g},m):null,a.createElement("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM18.584 5.106a.75.75 0 0 1 1.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 0 1-1.06-1.06 8.25 8.25 0 0 0 0-11.668.75.75 0 0 1 0-1.06Z"}),a.createElement("path",{d:"M15.932 7.757a.75.75 0 0 1 1.061 0 6 6 0 0 1 0 8.486.75.75 0 0 1-1.06-1.061 4.5 4.5 0 0 0 0-6.364.75.75 0 0 1 0-1.06Z"}))}const Y=a.forwardRef(X);function K({title:m,titleId:g,...u},f){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:f,"aria-labelledby":g},u),m?a.createElement("title",{id:g},m):null,a.createElement("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM17.78 9.22a.75.75 0 1 0-1.06 1.06L18.44 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06l1.72-1.72 1.72 1.72a.75.75 0 1 0 1.06-1.06L20.56 12l1.72-1.72a.75.75 0 1 0-1.06-1.06l-1.72 1.72-1.72-1.72Z"}))}const Q=a.forwardRef(K);function ae(){const[m,g]=a.useState(!1),[u,f]=a.useState(!1),[E,P]=a.useState(80),[b,S]=a.useState(!0),[n,M]=a.useState(null),[h,F]=a.useState(1),[p,V]=a.useState(""),[B,j]=a.useState([]),[x,w]=a.useState({song:"",artist:"",dedication:""}),[i,y]=a.useState({id:1,question:"Which song should we play next?",options:[{id:1,text:"Song Title 1",votes:10},{id:2,text:"Song Title 2",votes:15},{id:3,text:"Song Title 3",votes:25}],totalVotes:50,userVoted:!1}),[_,D]=a.useState(null),[A,N]=a.useState(!1),[k,I]=a.useState("song"),[T,ee]=a.useState({title:"Higher Ground",artist:"TNGHT"});a.useEffect(()=>{const t=async()=>{try{const s=(await q.getLive()).data;if(s&&s.length>0){S(!0);const c=s[0];F(c.id),console.log("Live broadcast:",c)}else{S(!1);try{const o=(await q.getUpcoming()).data;if(o&&o.length>0){const d=o[0];M({title:d.title,date:new Date(d.scheduledStart).toLocaleDateString(),time:new Date(d.scheduledStart).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})}else M(null)}catch(c){console.error("Error fetching upcoming broadcasts:",c)}}}catch(l){console.error("Error checking broadcast status:",l),S(!1)}};t();const r=setInterval(t,6e4);return()=>clearInterval(r)},[]),a.useEffect(()=>{if(h){const t=async()=>{try{const l=await C.getMessages(h);j(l.data.filter(s=>s.broadcastId===h)),setTimeout(()=>{const s=document.querySelector(".chat-messages-container");s&&(s.scrollTop=s.scrollHeight)},100)}catch(l){console.error("Error fetching chat messages:",l)}};t();const r=setInterval(t,5e3);return()=>{clearInterval(r),j([])}}else j([])},[h]),a.useEffect(()=>{if(h&&b){const t=async()=>{try{N(!0);const l=await v.getActivePollsForBroadcast(h);if(l.data&&l.data.length>0){const s=l.data[0];try{if((await v.hasUserVoted(s.id)).data){const o=await v.getUserVote(s.id);D(o.data);const d=await v.getPollResults(s.id);y({...s,options:d.data.options,totalVotes:d.data.totalVotes,userVoted:!0,userVotedFor:o.data.optionId})}else y({...s,totalVotes:s.options.reduce((o,d)=>o+d.votes,0),userVoted:!1})}catch(c){console.error("Error checking user vote:",c),y({...s,totalVotes:s.options.reduce((o,d)=>o+d.votes,0),userVoted:!1})}}else y(null)}catch(l){console.error("Error fetching active polls:",l)}finally{N(!1)}};t();const r=setInterval(t,1e4);return()=>clearInterval(r)}else y(null)},[h,b]);const $=()=>{f(!u)},H=t=>{const r=Number.parseInt(t.target.value,10);P(r),r===0?f(!0):u&&f(!1)},W=async t=>{var l,s,c;if(t.preventDefault(),!p.trim()||!h)return;if(p.length>1500){alert("Message cannot exceed 1500 characters");return}const r=p.trim();V("");try{const o={content:r};await C.sendMessage(h,o);const d=await C.getMessages(h);j(d.data);const R=document.querySelector(".chat-messages-container");R&&(R.scrollTop=R.scrollHeight)}catch(o){console.error("Error sending chat message:",o),(c=(s=(l=o.response)==null?void 0:l.data)==null?void 0:s.message)!=null&&c.includes("1500 characters")?alert("Message cannot exceed 1500 characters"):alert("Failed to send message. Please try again."),V(r)}},U=async t=>{if(t.preventDefault(),!(!x.song.trim()||!x.artist.trim()||!h))try{const r={songTitle:x.song,artist:x.artist,dedication:x.dedication};await O.createRequest(h,r),alert(`Song request submitted: "${x.song}" by ${x.artist}`),w({song:"",artist:"",dedication:""})}catch(r){console.error("Error submitting song request:",r),alert("Failed to submit song request. Please try again.")}},Z=async t=>{if(!(!i||i.userVoted||!b))try{N(!0);const r={pollId:i.id,optionId:t};await v.vote(i.id,r);const l=await v.getPollResults(i.id),s=await v.getUserVote(i.id);D(s.data),y(c=>({...c,options:l.data.options,totalVotes:l.data.totalVotes,userVoted:!0,userVotedFor:t}))}catch(r){console.error("Error submitting vote:",r),alert("Failed to submit vote. Please try again.")}finally{N(!1)}};return e.jsxs("div",{className:"container mx-auto px-4 pb-6 bg-gray-100 dark:bg-gray-900",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 pt-6",children:"Broadcast Stream"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col",children:[e.jsxs("div",{className:"bg-maroon-700 rounded-lg overflow-hidden mb-6 h-[200px] flex flex-col justify-center",children:[e.jsx("div",{className:"absolute p-2 px-4",children:b?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-600 text-white",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-white mr-1 animate-pulse"}),"LIVE"]}):e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-600 text-white",children:"OFF AIR"})}),b?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex p-4",children:[e.jsx("div",{className:"w-24 h-24 bg-maroon-800 flex items-center justify-center text-white text-2xl rounded-lg",children:"$"}),e.jsxs("div",{className:"ml-4 text-white",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Afternoon Mix"}),e.jsx("p",{className:"text-sm opacity-80",children:"Hosted by DJ Wildcat"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs uppercase opacity-60",children:"NOW PLAYING"}),e.jsx("p",{className:"text-sm font-medium",children:T.title}),e.jsx("p",{className:"text-xs opacity-70",children:T.artist})]})]})]}),e.jsxs("div",{className:"flex items-center px-4 py-3",children:[e.jsx("button",{onClick:$,className:"text-white mr-2",children:u?e.jsx(Q,{className:"h-5 w-5"}):e.jsx(Y,{className:"h-5 w-5"})}),e.jsx("input",{type:"range",min:"0",max:"100",value:E,onChange:H,className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"ml-2 text-white text-xs w-7 text-right",children:[E,"%"]})]})]}):e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",children:"WildCats Radio"}),e.jsx("p",{className:"mb-2",children:"No broadcast currently active"}),n?e.jsxs("p",{className:"text-sm opacity-70",children:["Next broadcast: ",n.title," on ",n.date," at ",n.time]}):e.jsx("p",{className:"text-sm opacity-70",children:"No upcoming broadcasts scheduled"})]})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden flex-grow",children:[e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>I("song"),className:`flex-1 py-3 px-4 text-center text-sm font-medium ${k==="song"?"border-b-2 border-maroon-700 text-maroon-700 dark:border-maroon-500 dark:text-maroon-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b border-gray-200 dark:border-gray-700"}`,children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(L,{className:"h-5 w-5 mr-2"}),"Song Request"]})}),e.jsx("button",{onClick:()=>I("poll"),className:`flex-1 py-3 px-4 text-center text-sm font-medium ${k==="poll"?"border-b-2 border-maroon-700 text-maroon-700 dark:border-maroon-500 dark:text-maroon-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b border-gray-200 dark:border-gray-700"}`,children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Poll"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 flex-grow flex flex-col h-[450px]",children:[k==="song"&&e.jsx("div",{className:"p-6 flex-grow flex flex-col h-full",children:b?e.jsxs("form",{onSubmit:U,className:"space-y-5 flex-grow flex flex-col",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Song Title"}),e.jsx("input",{type:"text",value:x.song,onChange:t=>w({...x,song:t.target.value}),placeholder:"Enter song title",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Artist"}),e.jsx("input",{type:"text",value:x.artist,onChange:t=>w({...x,artist:t.target.value}),placeholder:"Enter artist name",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Dedication (Optional)"}),e.jsx("textarea",{value:x.dedication,onChange:t=>w({...x,dedication:t.target.value}),placeholder:"Add a message or dedication",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-full min-h-[120px]"})]}),e.jsxs("div",{className:"mt-auto flex justify-between items-center",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Song requests are subject to availability and DJ's playlist."}),e.jsx("button",{type:"submit",className:"bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 px-6 rounded",children:"Submit Request"})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center w-full",children:[e.jsxs("div",{className:"flex items-center mb-8 justify-center",children:[e.jsx("div",{className:"bg-pink-100 dark:bg-maroon-900/30 rounded-full p-3 mr-4",children:e.jsx(L,{className:"h-6 w-6 text-maroon-600 dark:text-maroon-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-lg",children:"Request a Song"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Let us know what you'd like to hear next"})]})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Song requests are only available during live broadcasts"}),n&&e.jsxs("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:["Next broadcast: ",n.title," on ",n.date," at ",n.time]})]})})}),k==="poll"&&e.jsx("div",{className:"p-6 flex-grow flex flex-col h-full",children:b?e.jsx(e.Fragment,{children:A&&!i?e.jsx("div",{className:"text-center py-8 flex-grow flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 animate-pulse",children:"Loading polls..."})}):i?e.jsxs("div",{className:"flex-grow flex flex-col",children:[e.jsx("div",{className:"space-y-6 mb-6 flex-grow",children:i.options.map(t=>{const r=Math.round(t.votes/i.totalVotes*100)||0;return e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium mb-2 text-gray-900 dark:text-white",children:"Song Title"}),e.jsx("div",{className:"w-full bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md overflow-hidden",onClick:()=>!i.userVoted&&Z(t.id),children:e.jsxs("div",{className:"h-8 bg-pink-200 dark:bg-maroon-900/30 flex items-center pl-3 text-xs text-gray-800 dark:text-gray-200",style:{width:`${r}%`},children:[r,"%"]})})]},t.id)})}),e.jsx("div",{className:"mt-auto flex justify-center",children:e.jsx("button",{onClick:()=>y({...i,userVoted:!0}),disabled:i.userVoted,className:`bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 px-12 rounded ${i.userVoted?"opacity-50 cursor-not-allowed":""}`,children:"Vote"})})]}):e.jsx("div",{className:"text-center py-8 flex-grow flex items-center justify-center",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No active polls"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Active polls will appear during live broadcasts"})]})})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center w-full",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-medium text-gray-900 dark:text-white",children:"Vote"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"selects which you prefer the most?"})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Polls are only available during live broadcasts"}),n&&e.jsxs("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:["Next broadcast: ",n.title," on ",n.date," at ",n.time]})]})})})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 flex flex-col",children:[e.jsxs("div",{className:"bg-maroon-700 text-white p-3 rounded-t-lg",children:[e.jsx("h3",{className:"font-medium",children:"Live Chat"}),e.jsx("p",{className:"text-xs opacity-70",children:"00 listeners online"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-t-0 border-gray-200 dark:border-gray-700 rounded-b-lg flex-grow flex flex-col h-[494px]",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-grow overflow-y-auto p-4 space-y-4 chat-messages-container",children:B.map(t=>{const r=t.sender&&t.sender.name.includes("DJ"),l=t.sender.name.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2),s=t.createdAt?new Date(t.createdAt+"Z"):null,c=s?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(s):"Invalid Date",o=s?new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(s):"Invalid Time";return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("div",{className:`h-8 w-8 min-w-[2rem] rounded-full flex items-center justify-center text-xs text-white font-medium ${r?"bg-maroon-600":"bg-gray-500"}`,children:r?"DJ":l}),e.jsx("div",{className:"ml-2 overflow-hidden",children:e.jsx("span",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:t.sender.name})})]}),e.jsxs("div",{className:"ml-10 space-y-1",children:[e.jsx("div",{className:`rounded-lg p-3 message-bubble ${r?"bg-maroon-100 dark:bg-maroon-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 chat-message",style:{wordBreak:"break-word",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"100%"},children:t.content})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 pl-1",children:[c," â€¢ ",o]})]})]},t.id)})}),e.jsx("div",{className:"p-2 border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsxs("form",{onSubmit:W,className:"flex flex-col",children:[e.jsxs("div",{className:"flex mb-1",children:[e.jsx("input",{type:"text",value:p,onChange:t=>{t.target.value.length<=1500&&V(t.target.value)},placeholder:"Type your message...",className:"flex-1 p-2 border border-gray-300 dark:border-gray-600 rounded-l-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white max-w-full",maxLength:1500}),e.jsx("button",{type:"submit",disabled:!p.trim()||p.length>1500,className:`${!p.trim()||p.length>1500?"bg-gray-400 cursor-not-allowed":"bg-maroon-700 hover:bg-maroon-800 dark:bg-maroon-600"} text-white p-2 rounded-r-md flex-shrink-0`,children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:`${p.length>1500?"text-red-500":"text-gray-500 dark:text-gray-400"}`,children:[p.length,"/1500 characters"]}),p.length>1500&&e.jsx("span",{className:"text-red-500",children:"Message too long"})]})]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Chat is only available during live broadcasts"}),n?e.jsxs("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:["Next broadcast: ",n.title," on ",n.date," at ",n.time]}):e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"No upcoming broadcasts scheduled"})]})})})]})]})]})}export{ae as default};
