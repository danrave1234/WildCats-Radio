import{r as a,j as e,c as E,b as P,p as y,s as X}from"./index-5zlpEBiU.js";function Y({title:x,titleId:m,...u},h){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":m},u),x?a.createElement("title",{id:m},x):null,a.createElement("path",{fillRule:"evenodd",d:"M19.952 1.651a.75.75 0 0 1 .298.599V16.303a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.403-4.909l2.311-.66a1.5 1.5 0 0 0 1.088-1.442V6.994l-9 2.572v9.737a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.402-4.909l2.31-.66a1.5 1.5 0 0 0 1.088-1.442V5.25a.75.75 0 0 1 .544-.721l10.5-3a.75.75 0 0 1 .658.122Z",clipRule:"evenodd"}))}const q=a.forwardRef(Y);function K({title:x,titleId:m,...u},h){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":m},u),x?a.createElement("title",{id:m},x):null,a.createElement("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"}))}const Q=a.forwardRef(K);function _({title:x,titleId:m,...u},h){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":m},u),x?a.createElement("title",{id:m},x):null,a.createElement("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM18.584 5.106a.75.75 0 0 1 1.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 0 1-1.06-1.06 8.25 8.25 0 0 0 0-11.668.75.75 0 0 1 0-1.06Z"}),a.createElement("path",{d:"M15.932 7.757a.75.75 0 0 1 1.061 0 6 6 0 0 1 0 8.486.75.75 0 0 1-1.06-1.061 4.5 4.5 0 0 0 0-6.364.75.75 0 0 1 0-1.06Z"}))}const ee=a.forwardRef(_);function te({title:x,titleId:m,...u},h){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":m},u),x?a.createElement("title",{id:m},x):null,a.createElement("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM17.78 9.22a.75.75 0 1 0-1.06 1.06L18.44 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06l1.72-1.72 1.72 1.72a.75.75 0 1 0 1.06-1.06L20.56 12l1.72-1.72a.75.75 0 1 0-1.06-1.06l-1.72 1.72-1.72-1.72Z"}))}const ae=a.forwardRef(te);function oe(){const[x,m]=a.useState(!1),[u,h]=a.useState(!1),[C,A]=a.useState(80),[p,V]=a.useState(!0),[v,M]=a.useState(null),[g,F]=a.useState(1),[f,R]=a.useState(""),[$,w]=a.useState([]),[d,j]=a.useState({song:"",artist:"",dedication:""}),[i,b]=a.useState({id:1,question:"Which song should we play next?",options:[{id:1,text:"Song Title 1",votes:10},{id:2,text:"Song Title 2",votes:15},{id:3,text:"Song Title 3",votes:25}],totalVotes:50,userVoted:!1}),[se,B]=a.useState(null),[H,N]=a.useState(!1),[k,L]=a.useState("song"),[T,re]=a.useState({title:"Higher Ground",artist:"TNGHT"}),[W,U]=a.useState(!1),S=a.useRef(null),D=t=>{if(!t)return!0;const{scrollTop:s,scrollHeight:l,clientHeight:r}=t;return Math.abs(l-r-s)<10},I=()=>{const t=S.current;t&&(t.scrollTop=t.scrollHeight)};a.useEffect(()=>{if(g){const t=async()=>{try{const r=(await E.getMessages(g)).data.filter(c=>c.broadcastId===g),o=S.current,n=D(o);w(r),n&&setTimeout(()=>{o&&(o.scrollTop=o.scrollHeight)},100)}catch(l){console.error("Error fetching chat messages:",l)}};t();const s=setInterval(t,5e3);return()=>{clearInterval(s),w([])}}else w([])},[g]),a.useEffect(()=>{const t=S.current;if(!t)return;const s=()=>{U(!D(t))};return t.addEventListener("scroll",s),()=>t.removeEventListener("scroll",s)},[]);const Z=async t=>{var l,r,o;if(t.preventDefault(),!f.trim()||!g)return;if(f.length>1500){alert("Message cannot exceed 1500 characters");return}const s=f.trim();R("");try{const n={content:s};await E.sendMessage(g,n);const c=await E.getMessages(g);w(c.data),I()}catch(n){console.error("Error sending chat message:",n),(o=(r=(l=n.response)==null?void 0:l.data)==null?void 0:r.message)!=null&&o.includes("1500 characters")?alert("Message cannot exceed 1500 characters"):alert("Failed to send message. Please try again."),R(s)}};a.useEffect(()=>{const t=async()=>{try{const r=(await P.getLive()).data;if(r&&r.length>0){V(!0);const o=r[0];F(o.id),console.log("Live broadcast:",o)}else{V(!1);try{const n=(await P.getUpcoming()).data;if(n&&n.length>0){const c=n[0];M({title:c.title,date:new Date(c.scheduledStart).toLocaleDateString(),time:new Date(c.scheduledStart).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})}else M(null)}catch(o){console.error("Error fetching upcoming broadcasts:",o)}}}catch(l){console.error("Error checking broadcast status:",l),V(!1)}};t();const s=setInterval(t,6e4);return()=>clearInterval(s)},[]),a.useEffect(()=>{if(g&&p){const t=async()=>{try{N(!0);const l=await y.getActivePollsForBroadcast(g);if(l.data&&l.data.length>0){const r=l.data[0];try{if((await y.hasUserVoted(r.id)).data){const n=await y.getUserVote(r.id);B(n.data);const c=await y.getPollResults(r.id);b({...r,options:c.data.options,totalVotes:c.data.totalVotes,userVoted:!0,userVotedFor:n.data.optionId})}else b({...r,totalVotes:r.options.reduce((n,c)=>n+c.votes,0),userVoted:!1})}catch(o){console.error("Error checking user vote:",o),b({...r,totalVotes:r.options.reduce((n,c)=>n+c.votes,0),userVoted:!1})}}else b(null)}catch(l){console.error("Error fetching active polls:",l)}finally{N(!1)}};t();const s=setInterval(t,1e4);return()=>clearInterval(s)}else b(null)},[g,p]);const O=()=>{h(!u)},J=t=>{const s=Number.parseInt(t.target.value,10);A(s),s===0?h(!0):u&&h(!1)},z=async t=>{if(t.preventDefault(),!(!d.song.trim()||!d.artist.trim()||!g))try{const s={songTitle:d.song,artist:d.artist,dedication:d.dedication};await X.createRequest(g,s),alert(`Song request submitted: "${d.song}" by ${d.artist}`),j({song:"",artist:"",dedication:""})}catch(s){console.error("Error submitting song request:",s),alert("Failed to submit song request. Please try again.")}},G=async t=>{if(!(!i||i.userVoted||!p))try{N(!0);const s={pollId:i.id,optionId:t};await y.vote(i.id,s);const l=await y.getPollResults(i.id),r=await y.getUserVote(i.id);B(r.data),b(o=>({...o,options:l.data.options,totalVotes:l.data.totalVotes,userVoted:!0,userVotedFor:t}))}catch(s){console.error("Error submitting vote:",s),alert("Failed to submit vote. Please try again.")}finally{N(!1)}};return e.jsxs("div",{className:"container mx-auto px-4 pb-6 bg-gray-100 dark:bg-gray-900",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 pt-6",children:"Broadcast Stream"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col",children:[e.jsxs("div",{className:"bg-maroon-700 rounded-lg overflow-hidden mb-6 h-[200px] flex flex-col justify-center",children:[e.jsx("div",{className:"absolute p-2 px-4",children:p?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-600 text-white",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-white mr-1 animate-pulse"}),"LIVE"]}):e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-600 text-white",children:"OFF AIR"})}),p?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex p-4",children:[e.jsx("div",{className:"w-24 h-24 bg-maroon-800 flex items-center justify-center text-white text-2xl rounded-lg",children:"$"}),e.jsxs("div",{className:"ml-4 text-white",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Afternoon Mix"}),e.jsx("p",{className:"text-sm opacity-80",children:"Hosted by DJ Wildcat"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs uppercase opacity-60",children:"NOW PLAYING"}),e.jsx("p",{className:"text-sm font-medium",children:T.title}),e.jsx("p",{className:"text-xs opacity-70",children:T.artist})]})]})]}),e.jsxs("div",{className:"flex items-center px-4 py-3",children:[e.jsx("button",{onClick:O,className:"text-white mr-2",children:u?e.jsx(ae,{className:"h-5 w-5"}):e.jsx(ee,{className:"h-5 w-5"})}),e.jsx("input",{type:"range",min:"0",max:"100",value:C,onChange:J,className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"ml-2 text-white text-xs w-7 text-right",children:[C,"%"]})]})]}):e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",children:"WildCats Radio"}),e.jsx("p",{className:"mb-2",children:"No broadcast currently active"}),v?e.jsxs("p",{className:"text-sm opacity-70",children:["Next broadcast: ",v.title," on ",v.date," at ",v.time]}):e.jsx("p",{className:"text-sm opacity-70",children:"No upcoming broadcasts scheduled"})]})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden flex-grow",children:[e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>L("song"),className:`flex-1 py-3 px-4 text-center text-sm font-medium ${k==="song"?"border-b-2 border-maroon-700 text-maroon-700 dark:border-maroon-500 dark:text-maroon-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b border-gray-200 dark:border-gray-700"}`,children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Song Request"]})}),e.jsx("button",{onClick:()=>L("poll"),className:`flex-1 py-3 px-4 text-center text-sm font-medium ${k==="poll"?"border-b-2 border-maroon-700 text-maroon-700 dark:border-maroon-500 dark:text-maroon-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b border-gray-200 dark:border-gray-700"}`,children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Poll"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 flex-grow flex flex-col h-[450px]",children:[k==="song"&&e.jsx("div",{className:"p-6 flex-grow flex flex-col h-full",children:p?e.jsxs("form",{onSubmit:z,className:"space-y-5 flex-grow flex flex-col",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Song Title"}),e.jsx("input",{type:"text",value:d.song,onChange:t=>j({...d,song:t.target.value}),placeholder:"Enter song title",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Artist"}),e.jsx("input",{type:"text",value:d.artist,onChange:t=>j({...d,artist:t.target.value}),placeholder:"Enter artist name",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Dedication (Optional)"}),e.jsx("textarea",{value:d.dedication,onChange:t=>j({...d,dedication:t.target.value}),placeholder:"Add a message or dedication",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-full min-h-[120px]"})]}),e.jsxs("div",{className:"mt-auto flex justify-between items-center",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Song requests are subject to availability and DJ's playlist."}),e.jsx("button",{type:"submit",className:"bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 px-6 rounded",children:"Submit Request"})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center w-full",children:[e.jsxs("div",{className:"flex items-center mb-8 justify-center",children:[e.jsx("div",{className:"bg-pink-100 dark:bg-maroon-900/30 rounded-full p-3 mr-4",children:e.jsx(q,{className:"h-6 w-6 text-maroon-600 dark:text-maroon-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-lg",children:"Request a Song"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Let us know what you'd like to hear next"})]})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Song requests are only available during live broadcasts"})]})})}),k==="poll"&&e.jsx("div",{className:"p-6 flex-grow flex flex-col h-full",children:p?e.jsx(e.Fragment,{children:H&&!i?e.jsx("div",{className:"text-center py-8 flex-grow flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 animate-pulse",children:"Loading polls..."})}):i?e.jsxs("div",{className:"flex-grow flex flex-col",children:[e.jsx("div",{className:"space-y-6 mb-6 flex-grow",children:i.options.map(t=>{const s=Math.round(t.votes/i.totalVotes*100)||0;return e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium mb-2 text-gray-900 dark:text-white",children:"Song Title"}),e.jsx("div",{className:"w-full bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md overflow-hidden",onClick:()=>!i.userVoted&&G(t.id),children:e.jsxs("div",{className:"h-8 bg-pink-200 dark:bg-maroon-900/30 flex items-center pl-3 text-xs text-gray-800 dark:text-gray-200",style:{width:`${s}%`},children:[s,"%"]})})]},t.id)})}),e.jsx("div",{className:"mt-auto flex justify-center",children:e.jsx("button",{onClick:()=>b({...i,userVoted:!0}),disabled:i.userVoted,className:`bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 px-12 rounded ${i.userVoted?"opacity-50 cursor-not-allowed":""}`,children:"Vote"})})]}):e.jsx("div",{className:"text-center py-8 flex-grow flex items-center justify-center",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No active polls"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Active polls will appear during live broadcasts"})]})})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center w-full",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-medium text-gray-900 dark:text-white",children:"Vote"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"selects which you prefer the most?"})]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Polls are only available during live broadcasts"})]})})})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 flex flex-col",children:[e.jsxs("div",{className:"bg-maroon-700 text-white p-3 rounded-t-lg",children:[e.jsx("h3",{className:"font-medium",children:"Live Chat"}),e.jsx("p",{className:"text-xs opacity-70",children:"00 listeners online"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-t-0 border-gray-200 dark:border-gray-700 rounded-b-lg flex-grow flex flex-col h-[494px]",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:S,className:"flex-grow overflow-y-auto p-4 space-y-4 chat-messages-container relative",children:$.map(t=>{const s=t.sender&&t.sender.name.includes("DJ"),l=t.sender.name.split(" ").map(c=>c[0]).join("").toUpperCase().slice(0,2),r=t.createdAt?new Date(t.createdAt+"Z"):null,o=r?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(r):"Invalid Date",n=r?new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(r):"Invalid Time";return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("div",{className:`h-8 w-8 min-w-[2rem] rounded-full flex items-center justify-center text-xs text-white font-medium ${s?"bg-maroon-600":"bg-gray-500"}`,children:s?"DJ":l}),e.jsx("div",{className:"ml-2 overflow-hidden",children:e.jsx("span",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:t.sender.name})})]}),e.jsxs("div",{className:"ml-10 space-y-1",children:[e.jsx("div",{className:`rounded-lg p-3 message-bubble ${s?"bg-maroon-100 dark:bg-maroon-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 chat-message",style:{wordBreak:"break-word",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"100%"},children:t.content})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 pl-1",children:[o," • ",n]})]})]},t.id)})}),W&&e.jsx("div",{className:"absolute bottom-20 right-4",children:e.jsx("button",{onClick:I,className:"bg-maroon-600 hover:bg-maroon-700 text-white rounded-full p-2.5 shadow-lg transition-all duration-200 ease-in-out flex items-center justify-center","aria-label":"Scroll to bottom",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 10.293a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 111.414-1.414L10 15.586l5.293-5.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),e.jsx("div",{className:"p-2 border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsxs("form",{onSubmit:Z,className:"flex flex-col",children:[e.jsxs("div",{className:"flex mb-1",children:[e.jsx("input",{type:"text",value:f,onChange:t=>{t.target.value.length<=1500&&R(t.target.value)},placeholder:"Type your message...",className:"flex-1 p-2 border border-gray-300 dark:border-gray-600 rounded-l-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white max-w-full",maxLength:1500}),e.jsx("button",{type:"submit",disabled:!f.trim()||f.length>1500,className:`${!f.trim()||f.length>1500?"bg-gray-400 cursor-not-allowed":"bg-maroon-700 hover:bg-maroon-800 dark:bg-maroon-600"} text-white p-2 rounded-r-md flex-shrink-0`,children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:`${f.length>1500?"text-red-500":"text-gray-500 dark:text-gray-400"}`,children:[f.length,"/1500 characters"]}),f.length>1500&&e.jsx("span",{className:"text-red-500",children:"Message too long"})]})]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Chat is only available during live broadcasts"})})})})]})]})]})}export{oe as default};
