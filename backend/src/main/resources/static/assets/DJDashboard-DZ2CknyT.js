import{r as a,j as e,f as te,b as y,g as ue,p as re}from"./index-s7VrMFch.js";import{d as Te,T as nt,F as lt,c as dt,b as We}from"./Toast-DMUXSUji.js";import{F as Be}from"./XMarkIcon-7h1ye2T0.js";import{F as it}from"./UserGroupIcon-CthZUINU.js";import{F as ct}from"./PencilIcon-C1JrYomj.js";import"./CheckCircleIcon-DnCpmYom.js";function ut({title:n,titleId:l,...d},m){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},d),n?a.createElement("title",{id:l},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const mt=a.forwardRef(ut);function gt({title:n,titleId:l,...d},m){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},d),n?a.createElement("title",{id:l},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const ht=a.forwardRef(gt);function xt({title:n,titleId:l,...d},m){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},d),n?a.createElement("title",{id:l},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const Pe=a.forwardRef(xt);function bt({title:n,titleId:l,...d},m){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},d),n?a.createElement("title",{id:l},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"}))}const me=a.forwardRef(bt);function ft({title:n,titleId:l,...d},m){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},d),n?a.createElement("title",{id:l},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const pt=a.forwardRef(ft);function yt({title:n,titleId:l,...d},m){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},d),n?a.createElement("title",{id:l},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const vt=a.forwardRef(yt);function ge({isOpen:n,onClose:l,title:d,children:m,type:S="default",showCloseButton:D=!0,maxWidth:g="md",footer:C=null}){if(!n)return null;const k=()=>{switch(S){case"success":return"border-l-4 border-green-500";case"error":return"border-l-4 border-red-500";case"warning":return"border-l-4 border-yellow-500";case"info":return"border-l-4 border-blue-500";case"maroon":return"border-l-4 border-maroon-600";case"gold":return"border-l-4 border-gold-500";default:return""}},W=()=>{switch(S){case"success":return"text-green-700 dark:text-green-300";case"error":return"text-red-700 dark:text-red-300";case"warning":return"text-yellow-700 dark:text-yellow-300";case"info":return"text-blue-700 dark:text-blue-300";case"maroon":return"text-maroon-700 dark:text-maroon-400";case"gold":return"text-gold-600 dark:text-gold-400";default:return"text-gray-900 dark:text-white"}},N=()=>{switch(g){case"sm":return"max-w-sm";case"md":return"max-w-md";case"lg":return"max-w-lg";case"xl":return"max-w-xl";case"2xl":return"max-w-2xl";case"full":return"max-w-full mx-4";default:return"max-w-md"}};return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50 px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm",onClick:l,"aria-hidden":"true"}),e.jsxs("div",{className:`relative bg-white dark:bg-gray-800 rounded-xl shadow-xl ${N()} w-full transform transition-all ${k()}`,children:[d&&e.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:`text-lg font-semibold ${W()}`,children:d}),D&&e.jsx("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none","aria-label":"Close modal",children:e.jsx(Be,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-5 text-gray-700 dark:text-gray-300",children:m}),C&&e.jsx("div",{className:"p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3",children:C})]})]})}function wt({isOpen:n,onClose:l,onConfirm:d,title:m="Confirmation",message:S="Are you sure you want to proceed?",confirmLabel:D="Confirm",cancelLabel:g="Cancel",type:C="warning"}){if(!n)return null;const k=()=>{switch(C){case"warning":return e.jsx(Te,{className:"h-10 w-10 text-yellow-500"});case"danger":return e.jsx(Te,{className:"h-10 w-10 text-red-500"});case"info":return e.jsx(me,{className:"h-10 w-10 text-blue-500"});case"question":return e.jsx(me,{className:"h-10 w-10 text-maroon-500"});default:return e.jsx(me,{className:"h-10 w-10 text-gray-500"})}},W=()=>{switch(C){case"warning":return"bg-yellow-500 hover:bg-yellow-600 focus:ring-yellow-500";case"danger":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"info":return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500";case"question":return"bg-maroon-700 hover:bg-maroon-800 focus:ring-maroon-500";default:return"bg-maroon-700 hover:bg-maroon-800 focus:ring-maroon-500"}};return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50 px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm",onClick:l,"aria-hidden":"true"}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full transform transition-all",children:[e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none","aria-label":"Close dialog",children:e.jsx(Be,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:k()}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:m}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:S})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3 space-y-3 space-y-reverse sm:space-y-0",children:[e.jsx("button",{type:"button",onClick:l,className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-maroon-500",children:g}),e.jsx("button",{type:"button",onClick:()=>{d(),l()},className:`inline-flex justify-center px-4 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${W()}`,children:D})]})]})]})]})}function qt(){var Ae;const[n,l]=a.useState(!1),[d,m]=a.useState(!1),[S,D]=a.useState(0),[g,C]=a.useState("default"),[k,W]=a.useState([]),[N,b]=a.useState(null),[Z,Ie]=a.useState([]),[f,he]=a.useState(!1),[j,F]=a.useState(null),[P,xe]=a.useState(null),[be,fe]=a.useState(null),i=a.useRef(null),U=a.useRef(null),v=a.useRef(0),A=5,[R,J]=a.useState(!1),[kt,z]=a.useState(null),[jt,pe]=a.useState(!1),[B,se]=a.useState([]),[p,Y]=a.useState({dayOfWeek:"MONDAY",scheduledStart:"",scheduledEnd:"",automatic:!0}),[Nt,St]=a.useState(!1),[Q,ae]=a.useState("MONDAY"),[X,c]=a.useState({visible:!1,message:"",type:"success"}),[E,ye]=a.useState(null),[$e,oe]=a.useState(!1),[ne,_]=a.useState(!1),[q,Le]=a.useState({isOpen:!1,message:"",type:"success"}),[H,I]=a.useState({isOpen:!1,message:"",type:"success"}),[$,V]=a.useState({isOpen:!1,isEdit:!1}),[K,Et]=a.useState({viewerCount:0,peakViewers:0,chatMessages:0,songRequests:0}),[ve,Ct]=a.useState([]),[we,Rt]=a.useState([]),[ke,Fe]=a.useState([]),[L,G]=a.useState({question:"",options:["",""],broadcastId:null}),[Ue,ze]=a.useState({}),[Mt,je]=a.useState(null),[Dt,At]=a.useState(!1),[Ot,Tt]=a.useState(0),[Wt,Ye]=a.useState(new Date),[Pt,le]=a.useState("Standby"),[Bt,It]=a.useState(!1),Ne=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices){console.error("MediaDevices API not supported in this browser"),c({visible:!0,message:"Audio input detection not supported in this browser",type:"error"});return}await navigator.mediaDevices.getUserMedia({audio:!0});const r=(await navigator.mediaDevices.enumerateDevices()).filter(s=>s.kind==="audioinput").map(s=>({id:s.deviceId,label:s.label||`Microphone ${s.deviceId.slice(0,5)}...`}));r.length===0?(console.warn("No audio input devices detected"),c({visible:!0,message:"No microphones detected. Please connect a microphone.",type:"warning"})):(console.log("Available audio devices:",r),W(r),g==="default"&&r.length>0&&C(r[0].id))}catch(t){console.error("Error accessing microphone:",t);let r="Could not access microphone. ";t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?r+="Microphone permission was denied. Please check your browser settings.":t.name==="NotFoundError"?r+="No microphone found. Please connect a microphone.":t.name==="NotReadableError"||t.name==="TrackStartError"?r+="Microphone is already in use by another application.":r+="Please check your permissions and try again.",c({visible:!0,message:r,type:"error"}),W([])}},M=async()=>{try{if(console.log("Connecting to WebSocket for streaming..."),i.current){try{(i.current.readyState===WebSocket.OPEN||i.current.readyState===WebSocket.CONNECTING)&&(i.current.close(),console.log("Closed existing WebSocket connection"))}catch(s){console.error("Error closing existing WebSocket:",s)}i.current=null}const t=te.getStreamUrl();console.log(`Using WebSocket URL: ${t}`);const r=new WebSocket(t);return r.binaryType="arraybuffer",i.current=r,r.onopen=()=>{console.log("WebSocket connection established"),v.current=0,pe(!0),setTimeout(()=>{try{const s=new ArrayBuffer(16);r.send(s),console.log("Sent test data to WebSocket"),Se(r)}catch(s){console.error("Error sending test data to WebSocket:",s),Se(r)}},300),le("LIVE ON AIR"),c({visible:!0,message:"Broadcasting started. You are now live!",type:"success"})},r.onclose=s=>{if(console.log(`WebSocket connection closed: ${s.code} ${s.reason}`),R&&v.current<A){v.current++;const o=Math.min(1e3*Math.pow(2,v.current),1e4);console.log(`Attempting to reconnect (${v.current}/${A}) in ${o/1e3} seconds...`),c({visible:!0,message:`Connection lost. Reconnecting (attempt ${v.current}/${A})...`,type:"warning"}),setTimeout(M,o)}else v.current>=A&&(console.error(`Maximum retry attempts (${A}) reached. Stopping stream.`),c({visible:!0,message:"Unable to establish connection. Broadcast stopped.",type:"error"}),O(),l(!1),b(null))},r.onerror=s=>{console.error("WebSocket error:",s),z("Connection error occurred"),c({visible:!0,message:"WebSocket connection error. Please try again.",type:"error"})},r}catch(t){if(console.error("Error creating WebSocket connection:",t),z(`Connection error: ${t.message}`),c({visible:!0,message:`Failed to connect: ${t.message}`,type:"error"}),R&&v.current<A){v.current++;const r=Math.min(1e3*Math.pow(2,v.current),1e4);setTimeout(M,r)}else v.current>=A&&(J(!1),O(),l(!1),b(null));return null}},Se=t=>{if(!j){console.error("Cannot start recording: missing audio stream"),c({visible:!0,message:"Cannot start recording: No microphone connected",type:"error"});return}if(!t&&!i.current){console.error("Cannot start recording: missing WebSocket connection"),c({visible:!0,message:"Cannot start recording: No connection to server",type:"error"});return}t||i.current,t&&(!i.current||i.current!==t)&&(i.current=t);try{const r={mimeType:"audio/webm",audioBitsPerSecond:128e3};MediaRecorder.isTypeSupported(r.mimeType)?console.log("Using audio/webm format"):MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?(r.mimeType="audio/webm;codecs=opus",console.log("Using audio/webm;codecs=opus format")):MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")?(r.mimeType="audio/ogg;codecs=opus",console.log("Using audio/ogg;codecs=opus format")):MediaRecorder.isTypeSupported("audio/mp4")?(r.mimeType="audio/mp4",console.log("Using audio/mp4 format")):console.warn("No supported audio format found, using default");const s=new MediaRecorder(j,r);s.ondataavailable=async o=>{if(o.data.size>0&&i.current&&i.current.readyState===WebSocket.OPEN)try{const u=await o.data.arrayBuffer();console.log(`Sending ${u.byteLength} bytes of audio data to server`),i.current.send(u)}catch(u){console.error("Error sending audio data:",u),u.message.includes("null")&&R&&(console.warn("Socket disconnected unexpectedly, attempting to reconnect"),setTimeout(M,1e3))}else i.current&&i.current.readyState!==WebSocket.OPEN&&R&&(console.warn(`WebSocket not in OPEN state (current state: ${i.current.readyState})`),R&&i.current.readyState===WebSocket.CLOSED&&(console.warn("WebSocket closed but still streaming, attempting to reconnect"),setTimeout(M,1e3)))},s.onstart=()=>{console.log("MediaRecorder started"),J(!0),le("LIVE ON AIR")},s.onstop=()=>{console.log("MediaRecorder stopped")},s.onerror=o=>{console.error("MediaRecorder error:",o),z(`Recording error: ${o.message}`),c({visible:!0,message:`Recording error: ${o.message}`,type:"error"})},s.start(100),U.current=s,J(!0),z(null)}catch(r){console.error("Error starting MediaRecorder:",r),z(`Recording error: ${r.message}`),c({visible:!0,message:`Failed to start recording: ${r.message}`,type:"error"}),O(),l(!1),b(null)}},O=async()=>{try{if(N)try{await te.stop(),console.log("Backend notified of stream end")}catch(t){console.error("Error stopping stream on server:",t)}if(U.current&&U.current.state!=="inactive"){try{U.current.stop(),console.log("MediaRecorder stopped")}catch(t){console.error("Error stopping MediaRecorder:",t)}U.current=null}if(i.current){try{i.current.readyState===WebSocket.OPEN||i.current.readyState===WebSocket.CONNECTING?(i.current.close(),console.log("WebSocket connection closed")):console.log(`WebSocket already closing/closed (state: ${i.current.readyState})`)}catch(t){console.error("Error closing WebSocket:",t)}i.current=null}J(!1),pe(!1),le("Standby"),v.current=0,c({visible:!0,message:"Broadcasting stopped.",type:"info"})}catch(t){console.error("Error during streaming cleanup:",t)}},Ee=async()=>{if(f){if(j&&(j.getTracks().forEach(t=>t.stop()),F(null)),P){try{await P.close()}catch(t){console.error("Error closing audio context:",t)}xe(null),fe(null)}he(!1),D(0);return}try{const t={audio:{deviceId:g!=="default"?{exact:g}:void 0,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}};console.log("Starting audio preview with device:",g);const r=await navigator.mediaDevices.getUserMedia(t);F(r);const s=new(window.AudioContext||window.webkitAudioContext),o=s.createAnalyser();o.fftSize=1024,o.smoothingTimeConstant=.8;const u=s.createMediaStreamSource(r);u.connect(o);const h=s.createGain();h.gain.value=.5,u.connect(h),h.connect(s.destination),xe(s),fe(o),he(!0);const x=o.frequencyBinCount,w=new Uint8Array(x),T=()=>{if(o){try{o.getByteTimeDomainData(w);let ee=0;for(let ce=0;ce<x;ce++){const Oe=(w[ce]-128)/128;ee+=Oe*Oe}const ot=Math.sqrt(ee/x);let ie=Math.min(100,Math.max(0,Math.round(ot*200)));ie<5&&(ie=0),D(ie)}catch(ee){console.error("Error measuring audio level:",ee)}f&&requestAnimationFrame(T)}};T(),c({visible:!0,message:"Audio preview started. You should hear your voice now.",type:"success"})}catch(t){console.error("Error starting audio preview:",t),c({visible:!0,message:"Could not start audio preview: "+t.message,type:"error"})}};a.useEffect(()=>{let t;return n&&!f&&!be&&(console.log("Setting up simulated audio levels for broadcasting"),t=setInterval(()=>{let r=40+Math.random()*20;Math.random()>.8&&(r+=20+Math.random()*20),Math.random()>.9&&(r=Math.random()*10),r=Math.min(100,Math.round(r)),D(r)},200)),()=>{t&&clearInterval(t)}},[n,f,be]),a.useEffect(()=>{const t=setInterval(()=>{Ye(new Date)},1e3);return Ne(),()=>{clearInterval(t),R&&O(),j&&j.getTracks().forEach(r=>r.stop()),P&&P.close().catch(r=>{console.error("Error closing audio context during cleanup:",r)})}},[]),a.useEffect(()=>{const t=async()=>{try{const s=await y.getAll();Ie(s.data);const u=(await y.getLive()).data;if(u.length>0){if(l(!0),b(u[0].id),!R&&!i.current&&!j)try{const h={audio:{deviceId:g!=="default"?{exact:g}:void 0,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}},x=await navigator.mediaDevices.getUserMedia(h);F(x),M()}catch(h){console.error("Error reconnecting to active broadcast:",h)}}else n&&(R&&O(),l(!1),b(null))}catch(s){console.error("Error fetching broadcasts:",s)}};t();const r=setInterval(t,3e4);return()=>clearInterval(r)},[n]);const qe=t=>{C(t.target.value),f&&(j&&j.getTracks().forEach(r=>r.stop()),P&&P.close(),setTimeout(()=>{Ee()},100))},Ce=t=>{const{name:r,value:s}=t.target;Y(o=>({...o,[r]:s}))},He=t=>{ae(t.target.value),Y(r=>({...r,dayOfWeek:t.target.value}))},Re=async()=>{try{if(n&&N)await y.end(N),await O(),l(!1),m(!1),b(null),console.log("Ending broadcast");else{let t;Z.length>0&&(t=Z.find(s=>s.status==="SCHEDULED"));let r;if(t){const s=await y.start(t.id);r=t.id}else{const s={title:"Live Broadcast",description:"Started from DJ Dashboard",scheduledStart:new Date().toISOString(),scheduledEnd:new Date(Date.now()+36e5).toISOString()},u=(await y.schedule(s)).data,h=await y.start(u.id);r=u.id}b(r),l(!0),m(!1);try{await te.start(),console.log("Stream authorized")}catch(s){console.error("Error authorizing stream:",s),c({visible:!0,message:"Stream authorization failed. Please check that you have DJ permissions.",type:"error"});try{await y.end(r)}catch(o){console.error("Error ending broadcast after failed authorization:",o)}l(!1),b(null);return}if(j)await M();else try{const s={audio:{deviceId:g!=="default"?{exact:g}:void 0,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}};console.log("Starting broadcast"),console.log("Using audio device:",g);const o=await navigator.mediaDevices.getUserMedia(s);F(o),await new Promise(u=>setTimeout(u,200)),await M()}catch(s){console.error("Error accessing microphone:",s),c({visible:!0,message:`Could not access microphone: ${s.message}`,type:"error"});try{await y.end(r)}catch(o){console.error("Error ending broadcast after failed microphone access:",o)}l(!1),b(null);return}}}catch(t){console.error("Error toggling broadcast:",t),c({visible:!0,message:"There was an error with the broadcast: "+t.message,type:"error"}),n&&(O(),l(!1),b(null))}},Ve=async()=>{try{let t;Z.length>0&&(t=Z.find(s=>s.status==="SCHEDULED"));let r;if(t){const s=await y.startTest(t.id);r=t.id}else{const s={title:"Test Broadcast",description:"Test broadcast started from DJ Dashboard",scheduledStart:new Date().toISOString(),scheduledEnd:new Date(Date.now()+36e5).toISOString()},u=(await y.schedule(s)).data,h=await y.startTest(u.id);r=u.id}b(r),l(!0),m(!0);try{await te.start(),console.log("Test stream authorized")}catch(s){console.error("Error authorizing test stream:",s),c({visible:!0,message:"Test stream authorization failed. Check permissions.",type:"error"});try{await y.end(r)}catch(o){console.error("Error ending test broadcast after failed authorization:",o)}l(!1),b(null);return}if(!j)try{const s={audio:{deviceId:g!=="default"?{exact:g}:void 0,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}},o=await navigator.mediaDevices.getUserMedia(s);F(o)}catch(s){console.error("Error accessing microphone:",s),c({visible:!0,message:`Could not access microphone: ${s.message}`,type:"error"});try{await y.end(r)}catch(o){console.error("Error ending test broadcast after failed microphone access:",o)}l(!1),b(null);return}await M(),console.log("Starting TEST broadcast"),console.log("Using audio device:",g),c({visible:!0,message:"Test broadcast started. Audio is being streamed.",type:"success"})}catch(t){console.error("Error starting test broadcast:",t),c({visible:!0,message:"There was an error starting the test broadcast: "+t.message,type:"error"})}},Ge=()=>{d?m(!1):(l(!1),m(!0))},de=(t,r="success")=>{c({visible:!0,message:t,type:r})},Ze=async t=>{t.preventDefault();try{if(!p.scheduledStart||!p.scheduledEnd){de("Please enter both start and end times","error");return}if(p.scheduledStart>=p.scheduledEnd){de("End time must be after start time","error");return}const r=new Date,s=r.getDay();if({SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6}[p.dayOfWeek]===s){const[x,w]=p.scheduledStart.split(":").map(Number),T=new Date;if(T.setHours(x,w,0,0),T<r){de("Cannot schedule a broadcast in the past","error");return}}_(!0);const h=B.find(x=>x.dayOfWeek===p.dayOfWeek);if(h){const x={...h,scheduledStart:p.scheduledStart,scheduledEnd:p.scheduledEnd,automatic:p.automatic};await ue.updateSchedule(h.id,x),se(B.map(w=>w.id===h.id?x:w)),console.log("Updated server schedule:",x),I({isOpen:!0,message:"Server schedule updated successfully!",type:"success"})}else{const w=(await ue.createSchedule({...p,automatic:!0})).data;se([...B,w]),console.log("Created server schedule:",w),I({isOpen:!0,message:"Server schedule created successfully!",type:"success"})}Y({dayOfWeek:Q,scheduledStart:"",scheduledEnd:"",automatic:!0})}catch(r){console.error("Error saving server schedule:",r),I({isOpen:!0,message:"There was an error saving the schedule. Please try again.",type:"error"})}finally{_(!1)}},Je=t=>{ye(t),oe(!0)},Qe=async()=>{if(E)try{_(!0),await ue.deleteSchedule(E.id),se(B.filter(t=>t.id!==E.id)),oe(!1),ye(null),I({isOpen:!0,message:"Schedule deleted successfully!",type:"success"})}catch(t){console.error("Error deleting schedule:",t);let r="Failed to delete schedule. Please try again.";t.response&&(t.response.status===405?r="Server does not support schedule deletion. Please contact your administrator.":t.response.status===403?r="You do not have permission to delete this schedule.":t.response.data&&t.response.data.message&&(r=t.response.data.message)),I({isOpen:!0,message:r,type:"error"})}finally{_(!1)}},Me=async()=>{if(N)try{const t=await re.getPollsForBroadcast(N);Fe(t.data);const r=t.data.filter(s=>s.active);r.length>0?(je(r[0]),Xe(r[0].id)):je(null)}catch(t){console.error("Error fetching polls:",t)}},Xe=async t=>{try{const r=await re.getPollResults(t);ze(s=>({...s,[t]:r.data}))}catch(r){console.error("Error fetching poll results:",r)}},_e=t=>{const{name:r,value:s}=t.target;G(o=>({...o,[r]:s}))},Ke=(t,r)=>{G(s=>{const o=[...s.options];return o[t]=r,{...s,options:o}})},et=()=>{G(t=>({...t,options:[...t.options,""]}))},tt=t=>{L.options.length<=2||G(r=>{const s=[...r.options];return s.splice(t,1),{...r,options:s}})},rt=async t=>{if(t.preventDefault(),!N){alert("You must be broadcasting to create a poll");return}if(!L.question.trim()){alert("Please enter a question");return}const r=L.options.filter(s=>s.trim());if(r.length<2){alert("Please enter at least 2 options");return}try{const s={question:L.question,broadcastId:N,options:r};await re.createPoll(s),G({question:"",options:["",""],broadcastId:N}),Me(),alert("Poll created successfully!")}catch(s){console.error("Error creating poll:",s),alert("Failed to create poll. Please try again.")}},st=async t=>{try{await re.endPoll(t),Me()}catch(r){console.error("Error ending poll:",r),alert("Failed to end poll. Please try again.")}},at=t=>{const r=s=>{if(!s)return"";if(s.match(/^\d{2}:\d{2}$/))return s;try{const o=new Date(s);return isNaN(o.getTime())?"":`${String(o.getHours()).padStart(2,"0")}:${String(o.getMinutes()).padStart(2,"0")}`}catch(o){return console.error("Error formatting time:",o),""}};ae(t.dayOfWeek),Y({dayOfWeek:t.dayOfWeek,scheduledStart:r(t.scheduledStart),scheduledEnd:r(t.scheduledEnd),automatic:t.automatic}),V({isOpen:!0,isEdit:!0})},De=t=>{ae(t),Y({dayOfWeek:t,scheduledStart:"",scheduledEnd:"",automatic:!0}),V({isOpen:!0,isEdit:!1})};return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[X.visible&&e.jsx(nt,{message:X.message,type:X.type,onClose:()=>c({...X,visible:!1})}),e.jsx(wt,{isOpen:$e,onClose:()=>oe(!1),onConfirm:Qe,title:"Delete Schedule",message:`Are you sure you want to delete the schedule for ${(E==null?void 0:E.dayOfWeek.charAt(0))+(E==null?void 0:E.dayOfWeek.slice(1).toLowerCase())}?`,confirmText:"Delete",confirmButtonType:"danger",isLoading:ne}),e.jsx(ge,{isOpen:q.isOpen,onClose:()=>Le({...q,isOpen:!1}),title:q.type==="success"?"Success":"Error",type:q.type,maxWidth:"sm",children:e.jsx("p",{children:q.message})}),e.jsx(ge,{isOpen:H.isOpen,onClose:()=>I({...H,isOpen:!1}),title:H.type==="success"?"Success":"Error",type:H.type,maxWidth:"sm",children:e.jsx("p",{children:H.message})}),e.jsx(ge,{isOpen:$.isOpen,onClose:()=>V({...$,isOpen:!1}),title:`${$.isEdit?"Edit":"Add"} Schedule for ${Q.charAt(0)+Q.slice(1).toLowerCase()}`,maxWidth:"md",children:e.jsxs("form",{onSubmit:t=>{Ze(t),V({...$,isOpen:!1})},children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dayOfWeek",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Day of Week"}),e.jsxs("select",{id:"dayOfWeek",name:"dayOfWeek",value:Q,onChange:He,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white p-2 border",children:[e.jsx("option",{value:"MONDAY",children:"Monday"}),e.jsx("option",{value:"TUESDAY",children:"Tuesday"}),e.jsx("option",{value:"WEDNESDAY",children:"Wednesday"}),e.jsx("option",{value:"THURSDAY",children:"Thursday"}),e.jsx("option",{value:"FRIDAY",children:"Friday"}),e.jsx("option",{value:"SATURDAY",children:"Saturday"}),e.jsx("option",{value:"SUNDAY",children:"Sunday"})]})]}),e.jsxs("div",{className:"flex items-center mt-6",children:[e.jsx("input",{type:"checkbox",id:"automatic",name:"automatic",checked:!0,readOnly:!0,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"automatic",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:"Automatic (server will start/stop according to schedule)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"scheduledStart",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",name:"scheduledStart",id:"scheduledStart",value:p.scheduledStart,onChange:Ce,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white p-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"scheduledEnd",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Time"}),e.jsx("input",{type:"time",name:"scheduledEnd",id:"scheduledEnd",value:p.scheduledEnd,onChange:Ce,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white p-2 border"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>V({...$,isOpen:!1}),className:"inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-maroon-700 hover:bg-maroon-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-maroon-600",disabled:ne,children:ne?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"h-5 w-5 mr-1"}),$.isEdit?"Update":"Add"," Schedule"]})})]})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-8 text-center",children:"DJ Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Broadcast Controls"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Status"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n?"Broadcasting live":d?"Testing audio input":"Offline"})]}),e.jsx("div",{className:"flex space-x-4",children:n?e.jsx("button",{onClick:Re,className:"px-4 py-2 rounded-md text-white font-medium bg-red-600 hover:bg-red-700",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(pt,{className:"h-5 w-5 mr-1"}),"End Broadcast"]})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Re,className:"px-4 py-2 rounded-md text-white font-medium bg-yellow-500 hover:bg-yellow-600",disabled:d,children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(Pe,{className:"h-5 w-5 mr-1"}),"Start Broadcast"]})}),e.jsx("button",{onClick:Ve,className:"px-4 py-2 rounded-md text-white font-medium bg-purple-500 hover:bg-purple-600",disabled:d,children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(Pe,{className:"h-5 w-5 mr-1"}),"Test Broadcast"]})}),e.jsx("button",{onClick:Ge,className:`px-4 py-2 rounded-md font-medium ${d?"bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900 dark:text-red-200":"text-maroon-700 bg-maroon-100 hover:bg-maroon-200 dark:bg-maroon-900/30 dark:text-yellow-400 dark:hover:bg-maroon-900/50"}`,children:d?"Stop Test":"Test Audio"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"audioDevice",className:"block text-base font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Audio Input Device"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",className:"flex items-center text-sm px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 transition-colors",onClick:Ne,disabled:n,title:"Refresh device list",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-arrow-clockwise mr-1",viewBox:"0 0 16 16",children:[e.jsx("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),e.jsx("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})]}),"Refresh"]}),k.length>0&&!n&&!d&&e.jsx("button",{type:"button",className:`flex items-center text-sm px-2 py-1 rounded ${f?"bg-maroon-100 text-maroon-800 hover:bg-maroon-200 dark:bg-maroon-900 dark:text-maroon-200 dark:hover:bg-maroon-800":"bg-blue-100 text-blue-800 hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-200 dark:hover:bg-blue-800"} transition-colors`,onClick:Ee,disabled:!k.length,title:f?"Stop audio preview":"Preview microphone levels",children:f?e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"Stop Preview"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),"Preview"]})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:"audioDevice",className:"block w-full rounded-md border-gray-300 bg-white dark:bg-gray-700 pl-3 pr-10 py-2 text-base focus:outline-none focus:ring-2 focus:ring-maroon-500 focus:border-maroon-500 dark:border-gray-600 dark:text-white shadow-sm disabled:opacity-70 disabled:cursor-not-allowed appearance-none",value:g,onChange:qe,disabled:n,children:k.length>0?k.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id)):e.jsx("option",{value:"default",children:"No devices detected"})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300",children:e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),k.length===0&&e.jsxs("div",{className:"flex items-center mt-2 p-3 rounded-md bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-200",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm",children:"No audio devices detected. Please check your microphone permissions and connections, then click refresh."})]}),k.length>0&&!n&&!d&&e.jsxs("div",{className:"flex items-center mt-2 p-3 rounded-md bg-blue-50 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm",children:'Click "Test Audio" to verify your microphone is working properly before broadcasting.'})]})]}),(n||d||f)&&e.jsxs("div",{className:"mt-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Audio Input Level"}),f&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"Preview Mode"}),n&&!f&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"Live"}),d&&!f&&!n&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",children:"Test Mode"})]}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:`h-full transition-all duration-150 ${S>80?"bg-gradient-to-r from-red-500 to-red-600":S>60?"bg-gradient-to-r from-yellow-400 to-yellow-500":"bg-gradient-to-r from-green-400 to-green-500"}`,style:{width:`${S}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"h-2 w-2 bg-green-500 rounded-full mr-1"}),e.jsx("span",{children:"Low"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"h-2 w-2 bg-yellow-500 rounded-full mr-1"}),e.jsx("span",{children:"Medium"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"h-2 w-2 bg-red-500 rounded-full mr-1"}),e.jsxs("span",{children:["High (",S,"%)"]})]})]}),f&&e.jsxs("div",{className:"mt-3 text-sm bg-yellow-50 dark:bg-yellow-900/30 p-2 rounded text-yellow-800 dark:text-yellow-200 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),"If you experience audio feedback, try using headphones or lower your speaker volume."]}),e.jsxs("div",{className:"mt-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-medium",children:"Device in use: "}),((Ae=k.find(t=>t.id===g))==null?void 0:Ae.label)||"Default device"]})]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Recent Chat Messages"}),e.jsx("div",{className:"max-h-48 overflow-y-auto scrollbar-thin scrollbar-thumb-maroon-500 dark:scrollbar-thumb-maroon-700 scrollbar-track-gray-200 dark:scrollbar-track-gray-700",children:ve.length>0?e.jsx("ul",{className:"space-y-3",children:ve.map(t=>e.jsxs("li",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.sender?t.sender.name:"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.timestamp?new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.content})]},t.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No chat messages yet"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Song Requests"}),e.jsx("div",{className:"max-h-48 overflow-y-auto scrollbar-thin scrollbar-thumb-maroon-500 dark:scrollbar-thumb-maroon-700 scrollbar-track-gray-200 dark:scrollbar-track-gray-700",children:we.length>0?e.jsx("ul",{className:"space-y-3",children:we.map(t=>e.jsxs("li",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.songTitle," ",t.artist&&e.jsxs("span",{children:["by ",t.artist]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.timestamp?new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Requested by: ",t.requestedBy?t.requestedBy.name:"Unknown"]})]},t.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No song requests yet"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Create Poll"}),e.jsxs("form",{onSubmit:rt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"question",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Poll Question"}),e.jsx("input",{type:"text",id:"question",name:"question",value:L.question,onChange:_e,placeholder:"Enter your question here",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-maroon-500 focus:ring-maroon-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white p-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Poll Options"}),L.options.map((t,r)=>e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"text",value:t,onChange:s=>Ke(r,s.target.value),placeholder:`Option ${r+1}`,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-maroon-500 focus:ring-maroon-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white p-2 border mr-2",required:!0}),r>1&&e.jsx("button",{type:"button",onClick:()=>tt(r),className:"text-red-600 hover:text-red-800",children:"Remove"})]},r)),e.jsx("button",{type:"button",onClick:et,className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm",children:"+ Add Option"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-maroon-700 hover:bg-maroon-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-maroon-600",disabled:!n,children:"Create Poll"})})]}),ke.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Active Polls"}),e.jsx("div",{className:"space-y-4",children:ke.map(t=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t.question}),t.active&&e.jsx("button",{onClick:()=>st(t.id),className:"text-red-600 hover:text-red-800 text-sm",children:"End Poll"})]}),e.jsx("div",{className:"space-y-2",children:t.options.map((r,s)=>{const o=Ue[t.id]||{},u=o[r]||0,h=Object.values(o).reduce((w,T)=>w+T,0),x=h>0?Math.round(u/h*100):0;return e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:r}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[u," votes (",x,"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-maroon-500",style:{width:`${x}%`}})})]},s)})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:t.active?"Active":"Ended"})]},t.id))})]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Live Analytics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-200",children:"Current Listeners"}),e.jsx(it,{className:"h-5 w-5 text-red-600 dark:text-red-200"})]}),e.jsx("p",{className:"text-2xl font-semibold text-red-700 dark:text-red-100 mt-2",children:K.viewerCount})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-200",children:"Peak Listeners"}),e.jsx(mt,{className:"h-5 w-5 text-red-600 dark:text-red-200"})]}),e.jsx("p",{className:"text-2xl font-semibold text-red-700 dark:text-red-100 mt-2",children:K.peakViewers})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-200",children:"Chat Messages"}),e.jsx(ht,{className:"h-5 w-5 text-red-600 dark:text-red-200"})]}),e.jsx("p",{className:"text-2xl font-semibold text-red-700 dark:text-red-100 mt-2",children:K.chatMessages})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-200",children:"Song Requests"}),e.jsx(dt,{className:"h-5 w-5 text-red-600 dark:text-red-200"})]}),e.jsx("p",{className:"text-2xl font-semibold text-red-700 dark:text-red-100 mt-2",children:K.songRequests})]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Server Schedule Management"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b pb-2 border-gray-200 dark:border-gray-700",children:"Broadcast Details"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`h-3 w-3 rounded-full mr-2 ${n?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:n?"Broadcasting":"Not Broadcasting"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-1",children:"Shoutcast Status"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:n?"Connected":"Ready to connect"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-1",children:"Streaming Quality"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"128 kbps MP3"})]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Weekly Schedule"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:B.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-3",children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"].map(t=>{const r=B.find(s=>s.dayOfWeek===t);return e.jsxs("div",{className:"flex justify-between items-center p-2 border-b border-gray-200 dark:border-gray-600",children:[e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:t.charAt(0)+t.slice(1).toLowerCase()})}),e.jsx("div",{className:"flex-1",children:r?e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.scheduledStart," - ",r.scheduledEnd]}):e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-500 italic",children:"No schedule"})}),e.jsx("div",{className:"flex space-x-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>at(r),className:"p-1 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",title:"Edit schedule",children:e.jsx(ct,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>Je(r),className:"p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",title:"Delete schedule",children:e.jsx(vt,{className:"h-5 w-5"})})]}):e.jsx("button",{onClick:()=>De(t),className:"p-1 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",title:"Add schedule",children:e.jsx(We,{className:"h-5 w-5"})})})]},t)})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No schedules configured"}),e.jsxs("button",{onClick:()=>De("MONDAY"),className:"inline-flex items-center px-4 py-2 bg-maroon-600 hover:bg-maroon-700 text-white rounded-md",children:[e.jsx(We,{className:"h-5 w-5 mr-2"}),"Add Schedule"]})]})})]})]})})]})]})]})}export{qt as default};
